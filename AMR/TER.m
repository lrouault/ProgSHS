clear; clc; format long g; close all;
addpath(genpath('./'));

% Domaine [1,10]
% Condition initiale : T(x,0) = 0
% Condition limite   : T(1,t) = T(10,t) = 10

%% Données

%Valeur de référence calculée avec : Tfinal=10; Nbiter=2000; Lx=10; Nx=100;
ValRef = [10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10;9.20410762612821 9.43651520991857 9.53972491664517 9.60131054572325 9.64339203559888 9.67458346708526 9.69908283293222 9.71922517097234 9.73640975371466 9.75150960934681 9.76508230016251 9.77748996451677 9.78897166625574 9.79968825937102 9.80975059118130 9.81923734846539 9.82820638881139 9.83670195143871 9.84475925503503 9.85240743638559;8.42382098507744 8.87860947716478 9.08249801305319 9.20460463880788 9.28820497341104 9.35024865946405 9.39902453860662 9.43915360042454 9.47340905874921 9.50352271196062 9.53060110901595 9.55536309096247 9.57828319004016 9.59968065020461 9.61977542603346 9.63872363026787 9.65664004399457 9.67361244017573 9.68971071442521 9.70499271825405;7.64353434402667 8.32070374442461 8.62527113764459 8.80789961014959 8.93302379738729 9.02593285892511 9.09900735104473 9.15915184905209 9.21050986387070 9.25566863283956 9.29628133247666 9.33342216028585 9.36780056974100 9.39989418792676 9.43003239171824 9.45844919870611 9.48531685246890 9.51076719604673 9.53490530107475 9.55781817924165;6.90826423995959 7.77920700382457 8.17706847863916 8.41708630632710 8.58207149699829 8.70484074303573 8.80155214183306 8.88124937672365 8.94937149704642 9.00931901565489 9.06326633728497 9.11262689631046 9.15833439402534 9.20101751961837 9.24110989843958 9.27891970168116 9.31467385472837 9.34854616956783 9.38067527965401 9.41117609886206;6.17299413589252 7.23771026326657 7.72886588719303 8.02627493549759 8.23113166288824 8.38378807193630 8.50418122956960 8.60348901021976 8.68843868860588 8.76323745363055 8.83057630489645 8.89220529504729 8.94928133202829 9.00258418699515 9.05265238235280 9.09986920890603 9.14451735362724 9.18681366819618 9.22693134224111 9.26501407810845;5.50708913598272 6.72249977225346 7.29531044437514 7.64508961756071 7.88712852201307 8.06803728043103 8.21103189636287 8.32919271459382 8.43041467999427 8.51964338825545 8.60004517812945 8.67368047131886 8.74191196552967 8.80565854652362 8.86555516372924 8.92205407853979 8.97548917637264 9.02611689730387 9.07414233346511 9.11973590612045;4.84118413607292 6.20728928135462 6.86175513454886 7.26390766706675 7.54314586975811 7.75234929184256 7.91801425962703 8.05511576466590 8.17270540122929 8.27645743398952 8.37000680296368 8.45572055420210 8.53516574460122 8.60940048675668 8.67915717524863 8.74495851101722 8.80719120168995 8.86615287683698 8.92208201293587 8.97517706801811;4.26160015466994 5.72675641966307 6.44790689742241 6.89580582373865 7.20864518557855 7.44393743538133 7.63080666050810 7.78581648872838 7.91901462299715 8.03671251662539 8.14295816086289 8.24038974514635 8.33075506838583 8.41523519914611 8.49464843518098 8.56957952147579 8.64046174714749 8.70762920427393 8.77135011458213 8.83184813173679;3.68201617326696 5.24622355827084 6.03405890791364 6.52770942128303 6.87417531296203 7.13561626785450 7.34378457580807 7.51682127197320 7.66575540621739 7.79752294847049 7.91657635318879 8.02582029797508 8.12718165646868 8.22196475283245 8.31107522721296 8.39516186268043 8.47470670142849 8.55008242287959 8.62158895144235 8.68947687185518;3.19727320700265 4.80687922789625 5.64424083285820 6.17577401534663 6.55151407621757 6.83640474959049 7.06406420035427 7.25384744116263 7.41757199085029 7.56268748419313 7.69398307893604 7.81458643200432 7.92657440545245 8.03135446763321 8.12990529084150 8.22292925962273 8.31094939360931 8.39437105838957 8.47352133030570 8.54867416711755;2.71253024073835 4.36753489828500 5.25442320727073 5.82384711232569 6.22889730156179 6.53731811636817 6.78459190493256 6.99127242419956 7.16994716005612 7.32856409424583 7.47223898794229 7.60431719193971 7.72702384844326 7.84187017736030 7.94990980764986 8.05190127104391 8.14841128739735 8.23988054728205 8.32666569569930 8.40906619770627;2.32300464284739 3.97378290489454 4.89209279152090 5.49071368745764 5.92014952372448 6.24900164218714 6.51379323790952 6.73587561116104 6.92839003915636 7.09965721481403 7.25504204406038 7.39805749471441 7.53104332506752 7.65559112156577 7.77281276461007 7.88351070867221 7.98828623971840 8.08760842378817 8.18185810383150 8.27135604530781;1.93347904495642 3.58003091340231 4.52976317728161 5.15759329814603 5.61146444385115 5.96085257068401 6.24331644493550 6.48098502945580 6.68753122136820 6.87163084502494 7.03888675976701 7.19297397325386 7.33634534275560 7.47067387671109 7.59713218995408 7.71656978576515 7.82962579172059 7.93680078847940 8.03850267193624 8.13507601744579;1.63279261851428 3.23411794929553 4.19743552629881 4.84539581929449 5.31840467521477 5.68493434310250 5.98274574398189 6.23432765683703 6.45365503757320 6.64962352517249 6.82798959897989 6.99253531761703 7.14578941368843 7.28948031031455 7.42482268750469 7.55269937868925 7.67377706578790 7.78857999316019 7.89753702633377 8.00101177474009;1.33210619207213 2.88820498979326 3.86510928233997 4.53321804578098 5.02543198058977 5.40923664854763 5.72258459539558 5.98829927102229 6.22063202997519 6.42867897524165 6.61833842213161 6.79349399968764 6.95674925025777 7.10988966920084 7.25417512093319 7.39052550346682 7.51963887932194 7.64206677766235 7.75826230080267 7.86861094840689;1.10918349660640 2.59033549796442 3.56433330159147 4.24355716185281 4.74951016226986 5.14700998838191 5.47340656559245 5.75144476634592 5.99541962720650 6.21448808268562 6.41460208699406 6.59968872376107 6.77238666910256 6.93451057445581 7.08734533030207 7.23183301168439 7.36869184983732 7.49849207062850 7.62170433767709 7.73873078607518;0.886260801140676 2.29246601703307 3.26355975373025 3.95392570619283 4.47370785611856 4.88507021976341 5.22474249565401 5.51536006098871 5.77123281885082 6.00155802125224 6.21232945568357 6.40751270432221 6.58978124195382 6.76098129614929 6.92242661634331 7.07508582164700 7.21970168182304 7.35686719847523 7.48707424427178 7.61074475901267;0.727570068775242 2.04105324704465 2.99494498568635 3.68785977357257 4.21603609566000 4.63760709025860 4.98797119555918 5.28926568971706 5.55558946187189 5.79604150149736 6.01656843553062 6.22111494527792 6.41234833190522 6.59211732569847 6.76174339174911 6.92220598434538 7.07426052081018 7.21851363052362 7.35547125816280 7.48556951236756;0.568879336409808 1.78964050222550 2.72633436188895 3.42183729056530 3.95852670932065 4.39051341476824 4.75183802760983 5.06410273008003 5.34116395366518 5.59200147768443 5.82250357555613 6.03659005103753 6.23692271378617 6.42535613813929 6.60322412314216 6.77152197511987 6.93102265804347 7.08235093545823 7.22603081502628 7.36251601810364;0.460440669293428 1.58165360271557 2.48962241013093 3.17989520757173 3.71987801282185 4.15866004170709 4.52833218293027 4.84961523784259 5.13591336882838 5.39595473735886 5.63548246549392 5.85833262674745 6.06712043426981 6.26367684072019 6.44932636869658 6.62506400616528 6.79166794966028 6.94977157503968 7.09990949206081 7.24254712158608;0.352002002177050 1.37366675994728 2.25291741342197 2.93801656475655 3.48144785048307 3.92727824961788 4.30561162119927 4.63624430378529 4.93209487590907 5.20161935232439 5.45040580780504 5.68220405557748 5.89958469412737 6.10435946574080 6.29784908085520 6.48105388264829 6.65476270540593 6.81962243307090 6.97618256828061 7.12492390641988;0.280894679477785 1.20502879834822 2.04708916333237 2.72023033512544 3.26226631715882 3.71165775184975 4.09607436051407 4.43409840006970 4.73797714320095 5.01577286559513 5.27283678941278 5.51277591023386 5.73807610503527 5.95050080137833 6.15134533607197 6.34159913763685 6.52204920057482 6.69334621119147 6.85604692186651 7.01064141919787;0.209787356778528 1.03639096163176 1.84127241329952 2.50253571519672 3.04337623251204 3.49663428103913 3.88749587483646 4.23328041661220 4.54552970185379 4.83189312474827 5.09747717330161 5.34574540515669 5.57910252296059 5.79926925071302 6.00752190579306 6.20484532570059 6.39203054269171 6.56973728447576 6.73853409410836 6.89892420731139;0.165058557016095 0.902384155536187 1.66468056747430 2.30848975780493 2.84379774949379 3.29765596180335 3.69247874328449 4.04410003378257 4.36320096616562 4.65691124774072 4.93001831132604 5.18578961860814 5.42651064950671 5.65383140039931 5.86898815587190 6.07294514739526 6.26648506069938 6.45026696479737 6.62486351030500 6.79078493710883;0.120329757253710 0.768377617818475 1.48810745666362 2.11457463689476 2.64460448365101 3.09942757297484 3.49862368406075 3.85648771884328 4.18280640541329 4.48417307512848 4.76505096716826 5.02851317738201 5.27673131099406 5.51129155024213 5.73339741304005 5.94399947540455 6.14387838062509 6.33369806650844 6.51404002637441 6.68542549228891;0.0933504812065793 0.664018653448769 1.33862331414354 1.94346823827220 2.46448657236774 2.91730228459382 3.31853464184568 3.68078988579500 4.01284031462039 4.32065401462668 4.60830529166160 4.87862552191528 5.13363740182795 5.37483701831408 5.60337512560524 5.82017322136937 6.02599786277921 6.22150834646372 6.40728742512931 6.58386122378178;0.0663712051597411 0.559660252337108 1.18916924406364 1.77254664989941 2.28487328938910 2.73611177606418 3.13984427179687 3.50693144095236 3.84509939286997 4.15967787311040 4.45435057290209 4.73171162783686 4.99364216666453 5.24155646356891 5.47656068244736 5.69955477796936 5.91129789280910 6.11245043449120 6.30360128236785 6.48528551552383;0.0507738111953099 0.480018565006100 1.06433309980101 1.62326563616810 2.12383246525884 2.57087256805259 2.97495925019262 3.34513252344012 3.68799011394673 4.00815471950922 4.30886589285447 4.59243964100778 4.86058432805033 5.11460846455136 5.35555506814741 5.58428803132996 5.80154761125189 6.00798618181783 6.20419139977535 6.39070134885417;0.0351764172325285 0.400378032324409 0.939544516205193 1.47424280499034 1.96344682401872 2.40678971200102 2.81174624407520 3.18547760673958 3.53342516572722 3.85949624509788 4.16648870442617 4.45644798612108 4.73091915984486 4.99111464785763 5.23802336659548 5.47248120328333 5.69521649570694 5.90687948783470 6.10806154524362 6.29930782988971;0.0265378605771105 0.340821322144678 0.836710370156408 1.34543648307713 1.82090164534529 2.25831681176210 2.66222371687046 3.03790158944839 3.38959177972636 3.72043894688803 4.03275807778952 4.32829051452407 4.60839133977309 4.87415576365913 5.12650185704912 5.36622416487917 5.59402841863122 5.81055411560387 6.01638934099155 6.21208063408238;0.0178993039303109 0.281266924220428 0.733950336978181 1.21698687660510 1.67919955135691 2.11126352877413 2.51468656503524 2.89280923338392 3.24865066862345 3.58459047424257 3.90246792805480 4.20373117348414 4.48955697373717 4.76093436877263 5.01872043110522 5.26367685624209 5.49649394277211 5.71780641479058 5.92820399945357 6.12823863564208;0.0133182511680555 0.237629134735603 0.650417538677036 1.10714652818213 1.55441745012682 1.97931258845175 2.38058450149799 2.75969765469603 3.11844270263342 3.45840860336552 3.78093069488080 4.08713833051731 4.37800826208901 4.65440545699438 4.91711136423372 5.16684291407056 5.40426525561594 5.63000039678498 5.84463319269926 6.04871562097901;0.00873719844764340 0.193995869228894 0.566998530668487 0.997793595049643 1.43071053755772 1.84909125803416 2.24882416167327 2.62944573015285 2.99150383573614 3.33580143314699 3.66318228120015 3.97447133235499 4.27045918149378 4.55189905133790 4.81950731101590 5.07396494577341 5.31591923457586 5.54598542232724 5.76474832752328 5.97276387138307;0.00641248515267593 0.162671974186091 0.500125269497374 0.905329248269109 1.32285653592730 1.73332373169518 2.13011866048211 2.51096883129185 2.87520765632305 3.22284756831522 3.55422555204286 3.86984480349162 4.17029338608127 4.45619838125093 4.72819881093970 4.98692941562734 5.23301101533114 5.46704494954592 5.68961006359967 5.90126128410744;0.00408777204714848 0.131356727924979 0.433424147448455 0.813523535768663 1.21636143058349 1.61964746455994 2.01415673695954 2.39576461148619 2.76258578425414 3.11385480664177 3.44941977679787 3.76948003983974 4.07443707206181 4.36480528857685 4.64115746141732 4.90409110263084 5.15420784394788 5.39210095496015 5.61834797484656 5.83350655557903;0.00295960257632651 0.109335151197480 0.380720058708983 0.736836324256062 1.12454693815077 1.51966195522689 1.91076160034526 2.29203322869144 2.66043155347257 3.01442834592354 3.35338025805500 3.67717366197505 3.98601252572786 4.28028787816990 4.56049649789958 4.82719013225428 5.08094388954179 5.32233673311287 5.55193962445807 5.77030849767792;0.00183143390759513 0.0873297323611263 0.328272542941716 0.661029230452846 1.03443443336872 1.42218562754734 1.81055929223035 2.19202457740231 2.56238405942285 2.91936813242583 3.26186556283468 3.58947106423594 3.90220894098581 4.20036125941427 4.48436027627897 4.75472103393478 5.01199925280130 5.25676520451922 5.48958768765297 5.71102438561170;0.00130822580945397 0.0721768607367109 0.287469896306450 0.598577305624019 0.957764473876335 1.33754906024794 1.72234578595343 2.10310228978737 2.47455294194813 2.83371933755440 3.17903159466395 3.50979160156737 3.82583849211214 4.12733838490943 4.41465188723279 4.68825066190552 4.94866505262301 5.19645139163902 5.43217177959050 5.65638176186758;0.000785020895485157 0.0570534910033412 0.247044031832231 0.537288352414112 0.883206896048680 1.25589992781897 1.63782283659706 2.01838898621529 2.39128631372191 2.75285827182834 3.10110549566325 3.43506151622057 3.75439975669587 4.05918550354615 4.34971934658059 4.62643850021736 4.88985479550630 5.14051591131168 5.37898132797898 5.60580760016219;0.000553318217847072 0.0468658073023539 0.216148817006905 0.487644975295139 0.820824308188186 1.18617745789956 1.56463889356456 1.94430403317342 2.31791762233147 2.68119234507502 3.03171917669911 3.36826955396466 3.69035089451569 3.99792435197438 4.29122600645247 4.57065386013221 4.83669664756974 5.08988919407107 5.33078461587032 5.55993719417635;0.000321627419334359 0.0367307719772364 0.185798739249437 0.439521120781704 0.761039538433750 1.11998422476988 1.49569179100451 1.87494875170523 2.24959380347026 2.61474892191665 2.96762988430993 3.30677324481981 3.63154111129660 3.94180599953503 4.23775102746979 4.51974359941934 4.78825580243346 5.04381445595820 5.28696996835145 5.51827710966159;0.000223739200228060 0.0300692296195997 0.163124342893109 0.401424162679776 0.712164914384785 1.06476687452155 1.43737995272601 1.81570525174641 2.19079177991054 2.55722992197313 2.91188916064083 3.25308412388743 3.58003617835665 3.89252943536820 4.19069214437792 4.47485825981290 4.74548006739297 5.00307326292413 5.24818263157050 5.48136079013801;0.000125892713642325 0.0234995244712839 0.141226982701857 0.365290245709922 0.666455749388709 1.01368618087346 1.38389867435908 1.76174373825477 2.13753410931828 2.50537779356831 2.86183717070323 3.20503433256322 3.53407136705964 3.84865949327624 4.14888328426343 4.43505134189563 4.70760203661379 4.96704424034780 5.21392026797961 5.44878289859736;8.65168664313432e-05 0.0193186269615395 0.125414004109071 0.337682826018137 0.630422099187444 0.972615306052208 1.34031212284934 1.71733177506630 2.09337405808732 2.46213220947152 2.81989777430819 3.16461905302083 3.49528781396806 3.81154591169329 4.11343480958323 4.40123677265386 4.67537452487643 4.93634809024906 5.18469524656165 5.42096695683269;4.72793318075838e-05 0.0152943228188058 0.110692156745094 0.312582708129604 0.598209861329904 0.936354718147198 1.30219478432808 1.67878180104974 2.05527253165461 2.42500310736821 2.78403732733056 3.13018055415165 3.46233591557802 3.78009102712212 4.08345478861881 4.37269050098420 4.64821041634092 4.91050935566377 5.16012313154304 5.39760270263896;3.23502343880466e-05 0.0128756551206026 0.100718237218070 0.294645061361589 0.574491207243650 0.909142533461770 1.27321089481508 1.64918599096672 2.02580605460557 2.39612292858429 2.75601446111405 3.10316658269865 3.43640655769115 3.75527426916734 4.05974892422235 4.35007565778852 4.62665590382717 4.88997833876009 5.14057559478799 5.37899732188877;1.78543068439450e-05 0.0107180020174366 0.0922536625609264 0.279873374363834 0.555342739129634 0.887479258663659 1.25037575045487 1.62605472124155 2.00292167617370 2.37380909921565 2.73445477860361 3.08245667811114 3.41658747560509 3.73635362518463 4.04171423902782 4.33290272501712 4.61031401693392 4.87443353525650 5.12579265114674 5.36494096283350;1.29649568856561e-05 0.00961523479341896 0.0874370488063510 0.271046254171021 0.543576042593764 0.873924792586859 1.23590668936561 1.61126093739090 1.98818079497806 2.35935424487089 2.72042446085961 3.06892860461723 3.40360071736512 3.72392293374120 4.02983922952482 4.32157374452810 4.59951588559869 4.86414792607304 5.11599959952594 5.35561982001085;9.35942436195956e-06 0.00893777361520158 0.0846770171107059 0.266170866190100 0.537223435630072 0.866719499517951 1.22830103587163 1.60355041413118 1.98054882631050 2.35191027881498 2.71323068422236 3.06201751066044 3.39698636759156 3.71760809742164 4.02381988378196 4.31584189870913 4.59406134572881 4.85895939024535 5.11106533166892 5.35092805851074;9.35942436195956e-06 0.00893777361520158 0.0846770171107059 0.266170866190100 0.537223435630072 0.866719499517951 1.22830103587163 1.60355041413118 1.98054882631050 2.35191027881498 2.71323068422236 3.06201751066044 3.39698636759156 3.71760809742164 4.02381988378196 4.31584189870913 4.59406134572881 4.85895939024535 5.11106533166892 5.35092805851074;1.29649568856561e-05 0.00961523479341896 0.0874370488063510 0.271046254171021 0.543576042593764 0.873924792586859 1.23590668936561 1.61126093739090 1.98818079497806 2.35935424487089 2.72042446085961 3.06892860461723 3.40360071736512 3.72392293374120 4.02983922952482 4.32157374452810 4.59951588559869 4.86414792607304 5.11599959952594 5.35561982001085;1.78543068439450e-05 0.0107180020174366 0.0922536625609264 0.279873374363834 0.555342739129634 0.887479258663659 1.25037575045487 1.62605472124155 2.00292167617370 2.37380909921565 2.73445477860361 3.08245667811114 3.41658747560509 3.73635362518463 4.04171423902782 4.33290272501712 4.61031401693392 4.87443353525650 5.12579265114674 5.36494096283350;3.23502343880466e-05 0.0128756551206026 0.100718237218070 0.294645061361589 0.574491207243650 0.909142533461770 1.27321089481508 1.64918599096672 2.02580605460557 2.39612292858429 2.75601446111405 3.10316658269865 3.43640655769115 3.75527426916734 4.05974892422235 4.35007565778852 4.62665590382717 4.88997833876009 5.14057559478799 5.37899732188877;4.72793318075838e-05 0.0152943228188058 0.110692156745094 0.312582708129604 0.598209861329904 0.936354718147198 1.30219478432808 1.67878180104974 2.05527253165461 2.42500310736821 2.78403732733056 3.13018055415165 3.46233591557802 3.78009102712212 4.08345478861881 4.37269050098420 4.64821041634092 4.91050935566377 5.16012313154304 5.39760270263896;8.65168664313432e-05 0.0193186269615395 0.125414004109071 0.337682826018137 0.630422099187444 0.972615306052208 1.34031212284934 1.71733177506630 2.09337405808732 2.46213220947152 2.81989777430819 3.16461905302083 3.49528781396806 3.81154591169329 4.11343480958323 4.40123677265386 4.67537452487643 4.93634809024906 5.18469524656165 5.42096695683269;0.000125892713642325 0.0234995244712839 0.141226982701857 0.365290245709922 0.666455749388709 1.01368618087346 1.38389867435908 1.76174373825477 2.13753410931828 2.50537779356831 2.86183717070323 3.20503433256322 3.53407136705964 3.84865949327624 4.14888328426343 4.43505134189563 4.70760203661379 4.96704424034780 5.21392026797961 5.44878289859736;0.000223739200228060 0.0300692296195997 0.163124342893109 0.401424162679776 0.712164914384785 1.06476687452155 1.43737995272601 1.81570525174641 2.19079177991054 2.55722992197313 2.91188916064083 3.25308412388743 3.58003617835665 3.89252943536820 4.19069214437792 4.47485825981290 4.74548006739297 5.00307326292413 5.24818263157050 5.48136079013801;0.000321627419334359 0.0367307719772364 0.185798739249437 0.439521120781704 0.761039538433750 1.11998422476988 1.49569179100451 1.87494875170523 2.24959380347026 2.61474892191665 2.96762988430993 3.30677324481981 3.63154111129660 3.94180599953503 4.23775102746979 4.51974359941934 4.78825580243346 5.04381445595820 5.28696996835145 5.51827710966159;0.000553318217847072 0.0468658073023539 0.216148817006905 0.487644975295139 0.820824308188186 1.18617745789956 1.56463889356456 1.94430403317342 2.31791762233147 2.68119234507502 3.03171917669911 3.36826955396466 3.69035089451569 3.99792435197438 4.29122600645247 4.57065386013221 4.83669664756974 5.08988919407107 5.33078461587032 5.55993719417635;0.000785020895485157 0.0570534910033412 0.247044031832231 0.537288352414112 0.883206896048680 1.25589992781897 1.63782283659706 2.01838898621529 2.39128631372191 2.75285827182834 3.10110549566325 3.43506151622057 3.75439975669587 4.05918550354615 4.34971934658059 4.62643850021736 4.88985479550630 5.14051591131168 5.37898132797898 5.60580760016219;0.00130822580945397 0.0721768607367109 0.287469896306450 0.598577305624019 0.957764473876335 1.33754906024794 1.72234578595343 2.10310228978737 2.47455294194813 2.83371933755440 3.17903159466395 3.50979160156737 3.82583849211214 4.12733838490943 4.41465188723279 4.68825066190552 4.94866505262301 5.19645139163902 5.43217177959050 5.65638176186758;0.00183143390759513 0.0873297323611263 0.328272542941716 0.661029230452846 1.03443443336872 1.42218562754734 1.81055929223035 2.19202457740231 2.56238405942285 2.91936813242583 3.26186556283468 3.58947106423594 3.90220894098581 4.20036125941427 4.48436027627897 4.75472103393478 5.01199925280130 5.25676520451922 5.48958768765297 5.71102438561170;0.00295960257632651 0.109335151197480 0.380720058708983 0.736836324256062 1.12454693815077 1.51966195522689 1.91076160034526 2.29203322869144 2.66043155347257 3.01442834592354 3.35338025805500 3.67717366197505 3.98601252572786 4.28028787816990 4.56049649789958 4.82719013225428 5.08094388954179 5.32233673311287 5.55193962445807 5.77030849767792;0.00408777204714848 0.131356727924979 0.433424147448455 0.813523535768663 1.21636143058349 1.61964746455994 2.01415673695954 2.39576461148619 2.76258578425414 3.11385480664177 3.44941977679787 3.76948003983974 4.07443707206181 4.36480528857685 4.64115746141732 4.90409110263084 5.15420784394788 5.39210095496015 5.61834797484656 5.83350655557903;0.00641248515267593 0.162671974186091 0.500125269497374 0.905329248269109 1.32285653592730 1.73332373169518 2.13011866048211 2.51096883129185 2.87520765632305 3.22284756831522 3.55422555204286 3.86984480349162 4.17029338608127 4.45619838125093 4.72819881093970 4.98692941562734 5.23301101533114 5.46704494954592 5.68961006359967 5.90126128410744;0.00873719844764340 0.193995869228894 0.566998530668487 0.997793595049643 1.43071053755772 1.84909125803416 2.24882416167327 2.62944573015285 2.99150383573614 3.33580143314699 3.66318228120015 3.97447133235499 4.27045918149378 4.55189905133790 4.81950731101590 5.07396494577341 5.31591923457586 5.54598542232724 5.76474832752328 5.97276387138307;0.0133182511680555 0.237629134735603 0.650417538677036 1.10714652818213 1.55441745012682 1.97931258845175 2.38058450149799 2.75969765469603 3.11844270263342 3.45840860336552 3.78093069488080 4.08713833051731 4.37800826208901 4.65440545699438 4.91711136423372 5.16684291407056 5.40426525561594 5.63000039678498 5.84463319269926 6.04871562097901;0.0178993039303109 0.281266924220428 0.733950336978181 1.21698687660510 1.67919955135691 2.11126352877413 2.51468656503524 2.89280923338392 3.24865066862345 3.58459047424257 3.90246792805480 4.20373117348414 4.48955697373717 4.76093436877263 5.01872043110522 5.26367685624209 5.49649394277211 5.71780641479058 5.92820399945357 6.12823863564208;0.0265378605771105 0.340821322144678 0.836710370156408 1.34543648307713 1.82090164534529 2.25831681176210 2.66222371687046 3.03790158944839 3.38959177972636 3.72043894688803 4.03275807778952 4.32829051452407 4.60839133977309 4.87415576365913 5.12650185704912 5.36622416487917 5.59402841863122 5.81055411560387 6.01638934099155 6.21208063408238;0.0351764172325285 0.400378032324409 0.939544516205193 1.47424280499034 1.96344682401872 2.40678971200102 2.81174624407520 3.18547760673958 3.53342516572722 3.85949624509788 4.16648870442617 4.45644798612108 4.73091915984486 4.99111464785763 5.23802336659548 5.47248120328333 5.69521649570694 5.90687948783470 6.10806154524362 6.29930782988971;0.0507738111953099 0.480018565006100 1.06433309980101 1.62326563616810 2.12383246525884 2.57087256805259 2.97495925019262 3.34513252344012 3.68799011394673 4.00815471950922 4.30886589285447 4.59243964100778 4.86058432805033 5.11460846455136 5.35555506814741 5.58428803132996 5.80154761125189 6.00798618181783 6.20419139977535 6.39070134885417;0.0663712051597411 0.559660252337108 1.18916924406364 1.77254664989941 2.28487328938910 2.73611177606418 3.13984427179687 3.50693144095236 3.84509939286997 4.15967787311040 4.45435057290209 4.73171162783686 4.99364216666453 5.24155646356891 5.47656068244736 5.69955477796936 5.91129789280910 6.11245043449120 6.30360128236785 6.48528551552383;0.0933504812065793 0.664018653448769 1.33862331414354 1.94346823827220 2.46448657236774 2.91730228459382 3.31853464184568 3.68078988579500 4.01284031462039 4.32065401462668 4.60830529166160 4.87862552191528 5.13363740182795 5.37483701831408 5.60337512560524 5.82017322136937 6.02599786277921 6.22150834646372 6.40728742512931 6.58386122378178;0.120329757253710 0.768377617818475 1.48810745666362 2.11457463689476 2.64460448365101 3.09942757297484 3.49862368406075 3.85648771884328 4.18280640541329 4.48417307512848 4.76505096716826 5.02851317738201 5.27673131099406 5.51129155024213 5.73339741304005 5.94399947540455 6.14387838062509 6.33369806650844 6.51404002637441 6.68542549228891;0.165058557016095 0.902384155536187 1.66468056747430 2.30848975780493 2.84379774949379 3.29765596180335 3.69247874328449 4.04410003378257 4.36320096616562 4.65691124774072 4.93001831132604 5.18578961860814 5.42651064950671 5.65383140039931 5.86898815587190 6.07294514739526 6.26648506069938 6.45026696479737 6.62486351030500 6.79078493710883;0.209787356778528 1.03639096163176 1.84127241329952 2.50253571519672 3.04337623251204 3.49663428103913 3.88749587483646 4.23328041661220 4.54552970185379 4.83189312474827 5.09747717330161 5.34574540515669 5.57910252296059 5.79926925071302 6.00752190579306 6.20484532570059 6.39203054269171 6.56973728447576 6.73853409410836 6.89892420731139;0.280894679477785 1.20502879834822 2.04708916333237 2.72023033512544 3.26226631715882 3.71165775184975 4.09607436051407 4.43409840006970 4.73797714320095 5.01577286559513 5.27283678941278 5.51277591023386 5.73807610503527 5.95050080137833 6.15134533607197 6.34159913763685 6.52204920057482 6.69334621119147 6.85604692186651 7.01064141919787;0.352002002177050 1.37366675994728 2.25291741342197 2.93801656475655 3.48144785048307 3.92727824961788 4.30561162119927 4.63624430378529 4.93209487590907 5.20161935232439 5.45040580780504 5.68220405557748 5.89958469412737 6.10435946574080 6.29784908085520 6.48105388264829 6.65476270540593 6.81962243307090 6.97618256828061 7.12492390641988;0.460440669293428 1.58165360271557 2.48962241013093 3.17989520757173 3.71987801282185 4.15866004170709 4.52833218293027 4.84961523784259 5.13591336882838 5.39595473735886 5.63548246549392 5.85833262674745 6.06712043426981 6.26367684072019 6.44932636869658 6.62506400616528 6.79166794966028 6.94977157503968 7.09990949206081 7.24254712158608;0.568879336409808 1.78964050222550 2.72633436188895 3.42183729056530 3.95852670932065 4.39051341476824 4.75183802760983 5.06410273008003 5.34116395366518 5.59200147768443 5.82250357555613 6.03659005103753 6.23692271378617 6.42535613813929 6.60322412314216 6.77152197511987 6.93102265804347 7.08235093545823 7.22603081502628 7.36251601810364;0.727570068775242 2.04105324704465 2.99494498568635 3.68785977357257 4.21603609566000 4.63760709025860 4.98797119555918 5.28926568971706 5.55558946187189 5.79604150149736 6.01656843553062 6.22111494527792 6.41234833190522 6.59211732569847 6.76174339174911 6.92220598434538 7.07426052081018 7.21851363052362 7.35547125816280 7.48556951236756;0.886260801140676 2.29246601703307 3.26355975373025 3.95392570619283 4.47370785611856 4.88507021976341 5.22474249565401 5.51536006098871 5.77123281885082 6.00155802125224 6.21232945568357 6.40751270432221 6.58978124195382 6.76098129614929 6.92242661634331 7.07508582164700 7.21970168182304 7.35686719847523 7.48707424427178 7.61074475901267;1.10918349660640 2.59033549796442 3.56433330159147 4.24355716185281 4.74951016226986 5.14700998838191 5.47340656559245 5.75144476634592 5.99541962720650 6.21448808268562 6.41460208699406 6.59968872376107 6.77238666910256 6.93451057445581 7.08734533030207 7.23183301168439 7.36869184983732 7.49849207062850 7.62170433767709 7.73873078607518;1.33210619207213 2.88820498979326 3.86510928233997 4.53321804578098 5.02543198058977 5.40923664854763 5.72258459539558 5.98829927102229 6.22063202997519 6.42867897524165 6.61833842213161 6.79349399968764 6.95674925025777 7.10988966920084 7.25417512093319 7.39052550346682 7.51963887932194 7.64206677766235 7.75826230080267 7.86861094840689;1.63279261851428 3.23411794929553 4.19743552629881 4.84539581929449 5.31840467521477 5.68493434310250 5.98274574398189 6.23432765683703 6.45365503757320 6.64962352517249 6.82798959897989 6.99253531761703 7.14578941368843 7.28948031031455 7.42482268750469 7.55269937868925 7.67377706578790 7.78857999316019 7.89753702633377 8.00101177474009;1.93347904495642 3.58003091340231 4.52976317728161 5.15759329814603 5.61146444385115 5.96085257068401 6.24331644493550 6.48098502945580 6.68753122136820 6.87163084502494 7.03888675976701 7.19297397325386 7.33634534275560 7.47067387671109 7.59713218995408 7.71656978576515 7.82962579172059 7.93680078847940 8.03850267193624 8.13507601744579;2.32300464284739 3.97378290489454 4.89209279152090 5.49071368745764 5.92014952372448 6.24900164218714 6.51379323790952 6.73587561116104 6.92839003915636 7.09965721481403 7.25504204406038 7.39805749471441 7.53104332506752 7.65559112156577 7.77281276461007 7.88351070867221 7.98828623971840 8.08760842378817 8.18185810383150 8.27135604530781;2.71253024073835 4.36753489828500 5.25442320727073 5.82384711232569 6.22889730156179 6.53731811636817 6.78459190493256 6.99127242419956 7.16994716005612 7.32856409424583 7.47223898794229 7.60431719193971 7.72702384844326 7.84187017736030 7.94990980764986 8.05190127104391 8.14841128739735 8.23988054728205 8.32666569569930 8.40906619770627;3.19727320700265 4.80687922789625 5.64424083285820 6.17577401534663 6.55151407621757 6.83640474959049 7.06406420035427 7.25384744116263 7.41757199085029 7.56268748419313 7.69398307893604 7.81458643200432 7.92657440545245 8.03135446763321 8.12990529084150 8.22292925962273 8.31094939360931 8.39437105838957 8.47352133030570 8.54867416711755;3.68201617326696 5.24622355827084 6.03405890791364 6.52770942128303 6.87417531296203 7.13561626785450 7.34378457580807 7.51682127197320 7.66575540621739 7.79752294847049 7.91657635318879 8.02582029797508 8.12718165646868 8.22196475283245 8.31107522721296 8.39516186268043 8.47470670142849 8.55008242287959 8.62158895144235 8.68947687185518;4.26160015466994 5.72675641966307 6.44790689742241 6.89580582373865 7.20864518557855 7.44393743538133 7.63080666050810 7.78581648872838 7.91901462299715 8.03671251662539 8.14295816086289 8.24038974514635 8.33075506838583 8.41523519914611 8.49464843518098 8.56957952147579 8.64046174714749 8.70762920427393 8.77135011458213 8.83184813173679;4.84118413607292 6.20728928135462 6.86175513454886 7.26390766706675 7.54314586975811 7.75234929184256 7.91801425962703 8.05511576466590 8.17270540122929 8.27645743398952 8.37000680296368 8.45572055420210 8.53516574460122 8.60940048675668 8.67915717524863 8.74495851101722 8.80719120168995 8.86615287683698 8.92208201293587 8.97517706801811;5.50708913598272 6.72249977225346 7.29531044437514 7.64508961756071 7.88712852201307 8.06803728043103 8.21103189636287 8.32919271459382 8.43041467999427 8.51964338825545 8.60004517812945 8.67368047131886 8.74191196552967 8.80565854652362 8.86555516372924 8.92205407853979 8.97548917637264 9.02611689730387 9.07414233346511 9.11973590612045;6.17299413589252 7.23771026326657 7.72886588719303 8.02627493549759 8.23113166288824 8.38378807193630 8.50418122956960 8.60348901021976 8.68843868860588 8.76323745363055 8.83057630489645 8.89220529504729 8.94928133202829 9.00258418699515 9.05265238235280 9.09986920890603 9.14451735362724 9.18681366819618 9.22693134224111 9.26501407810845;6.90826423995959 7.77920700382457 8.17706847863916 8.41708630632710 8.58207149699829 8.70484074303573 8.80155214183306 8.88124937672365 8.94937149704642 9.00931901565489 9.06326633728497 9.11262689631046 9.15833439402534 9.20101751961837 9.24110989843958 9.27891970168116 9.31467385472837 9.34854616956783 9.38067527965401 9.41117609886206;7.64353434402667 8.32070374442461 8.62527113764459 8.80789961014959 8.93302379738729 9.02593285892511 9.09900735104473 9.15915184905209 9.21050986387070 9.25566863283956 9.29628133247666 9.33342216028585 9.36780056974100 9.39989418792676 9.43003239171824 9.45844919870611 9.48531685246890 9.51076719604673 9.53490530107475 9.55781817924165;8.42382098507744 8.87860947716478 9.08249801305319 9.20460463880788 9.28820497341104 9.35024865946405 9.39902453860662 9.43915360042454 9.47340905874921 9.50352271196062 9.53060110901595 9.55536309096247 9.57828319004016 9.59968065020461 9.61977542603346 9.63872363026787 9.65664004399457 9.67361244017573 9.68971071442521 9.70499271825405;9.20410762612821 9.43651520991857 9.53972491664517 9.60131054572325 9.64339203559888 9.67458346708526 9.69908283293222 9.71922517097234 9.73640975371466 9.75150960934681 9.76508230016251 9.77748996451677 9.78897166625574 9.79968825937102 9.80975059118130 9.81923734846539 9.82820638881139 9.83670195143871 9.84475925503503 9.85240743638559;10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 10];

T0=0;

Tfinal=10;  %temps final
Nbiter=20;  %Nb itérations

Lx=10;      %Longueur du barreau
Nx=10;      %Nb mailles sur le barreau

xxT=linspace(1,Lx,Nx);
xxVR=linspace(1,Lx,100);
%% Initialisation

T=zeros(Nx,1);
T(1,1)=10; T(Nx,1)=10;

Tnext=T;

%% Raffinement

Num=[4,7];            %Numéro du point a raffiner
nivRaf=[1,0,2];         %Niveau de raffinement du point
cond=10;              %Quand est ce qu'on doit la raffiner

N=2^(max(nivRaf)+1);
%% DF Explicite

dx=Lx/Nx;                                   %pas d'espace entre chaque point de discretisation
Nbiter=Nbiter*N;                             %adaptation de Nbiter et donc de dt pour avoir une bonne CFL
dt=Tfinal/Nbiter;                           %pas de temps entre chaque itération

for j=1:Nbiter
    %% Routine
    fprintf('Itération : %d \n',j)
    r=1;
    
    for k=2:Nx-1
        if (k==Num(r))&&(nivRaf(r)~=0)%&&(j==cond)
            Tnext(k)=Rafinement(T,k,nivRaf(r),dt,dx);
            if (r~=max(size(Num)))
                r=r+1;
            end
        else
            Tnext(k)=DF(T(k-1),T(k),T(k+1),dt,dx,dx);
        end
    end
    
    T=Tnext;
    
    %% Affichage
    if (mod(j,5*N)==0)
        figure(j); hold on; grid on;
        set(gca,'FontSize',25)
        plot(xxT,T,'r-','LineWidth',6);
        plot(xxVR,ValRef(:,j/N),'g-.','LineWidth',6); % 'k-+' 'g-.' 'r--'
        g1=sprintf('%d',Num);
        g2=sprintf('%d',nivRaf);
        lgd = legend(sprintf('Résolution avec %d mailles Raf = %s aux points %s',Nx,g2,g1),'Résolution avec 100 mailles sans Raf','Location','Best');
        set(lgd,'FontSize',15)
        title(sprintf('Iter %d; dt = %G; t = %G',j,dt,j*dt));
        xl = xlabel('Lx');
        set(xl,'FontSize',25)
        yl = ylabel('T');
        set(yl,'FontSize',25)
        axis([1 Lx 0 10])
    end
    
end

